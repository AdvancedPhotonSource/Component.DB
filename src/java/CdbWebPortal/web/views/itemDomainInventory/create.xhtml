<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"                
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                template="../item/private/templates/itemCreateWizardTemplate.xhtml">

    <f:metadata>
        <f:event type="preRenderComponent" listener="#{itemDomainInventoryController.processCreateRequestParams}"/>
        <f:event type="preRenderComponent" listener="#{logController.processPreRender()}"/>
    </f:metadata>

    <ui:param name="entityController" value="#{itemDomainInventoryController}"/>

    <ui:define name="additionalBasicInfo">
        <ui:include src="private/componentInventoryItemLocationEditPanelGrid.xhtml" />
    </ui:define>

    <ui:define name="additonalCreateItemContent">
        <ui:include src="private/componentInventoryItemLocationSelectDialog.xhtml" />
    </ui:define>

    <ui:define name="itemOverviewPanelGrid">
        <ui:include src="private/componentInventoryCreatePanelGrid.xhtml">
            <ui:param name="viewName" value="Overview" />
        </ui:include>
    </ui:define>

    <ui:define name="basicInformationTab"/>
    <ui:define name="permissionsTab"/>
    <ui:define name="reviewItemTab" />

    <ui:define name="additionalCreateWizardTabs">

        <p:tab id="itemElementInstantiation"
               title="Bill of Materials">
            <p:outputPanel styleClass="createWizardPanel">
                <p:panelGrid >
                    <f:facet name="header">
                        <p:row>
                            <p:column style="background: #C4C4C4 -moz-linear-gradient(center top , rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0)) repeat scroll 0% 0%;
                                      border: gray; border-style: solid; border-width: 1px; font-weight: bold;">Parts List</p:column>
                            <p:column style="background: #C4C4C4 -moz-linear-gradient(center top , rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0)) repeat scroll 0% 0%;
                                      border: gray; border-style: solid; border-width: 1px;">Add options for selected part</p:column>
                        </p:row>
                    </f:facet>

                    <p:row>
                        <p:column>
                            <p:tree value="#{itemDomainInventoryController.currentItemBOMListTree}"
                                    id="partsTree"
                                    var="inventoryBOM"
                                    selectionMode="single"
                                    selection="#{itemDomainInventoryController.selectedItemBOMTreeNode}"                                    
                                    >
                                <p:ajax event="select" update="@form"/>

                                <p:treeNode type="newItem" icon="ui-icon-plus">
                                    <h:outputText value="#{inventoryBOM.toString()}"/>
                                </p:treeNode>
                                <p:treeNode type="existingItem" icon="ui-icon-check">
                                    <h:outputText value="#{inventoryBOM.toString()}"/>
                                </p:treeNode>
                                <p:treeNode type="placeholder" icon="ui-icon-close">
                                    <h:outputText value="#{inventoryBOM.toString()}"/>
                                </p:treeNode>
                                <p:treeNode>
                                    <h:outputText value="#{inventoryBOM.toString()}"/>
                                </p:treeNode>
                            </p:tree>
                        </p:column>
                        <p:column>
                            <p:outputPanel rendered="#{itemDomainInventoryController.selectedItemBOMTreeNode != null}">
                                <ui:param name="billOfMaterialItem" value="#{itemDomainInventoryController.selectedItemBOMTreeNode.data}" />

                                <div>
                                    <h1 style="padding: 15px; padding-bottom: 20px; color: #4e80b6;">Define #{billOfMaterialItem.toString()}</h1>
                                </div>

                                <p:panelGrid columns="2" rendered="#{billOfMaterialItem.partItem}">
                                    <h:outputLabel for="newInstanceAddOptions" 
                                                   value="Select option for adding this part: " 
                                                   styleClass="entityDataEmphasizedLabel"/>
                                    <p:selectOneRadio id="newInstanceAddOptions"
                                                      value="#{billOfMaterialItem.state}"
                                                      styleClass="entityDataEmphasizedText">
                                        <f:selectItem itemLabel="Not Yet Defined" itemValue="placeholder"/>
                                        <f:selectItem itemLabel="Use Existing Item (Under dev)" itemDisabled="true" itemValue="existingItem" />
                                        <f:selectItem itemLabel="Create a New Instance" itemValue="newItem" />
                                        <p:ajax onstart="PF('loadingDialog').show()" oncomplete="PF('loadingDialog').hide()" update="@form"/>
                                    </p:selectOneRadio>
                                </p:panelGrid>
                                <p/>

                                <p:outputPanel rendered="#{itemDomainInventoryController.isRenderBomPlaceholder(billOfMaterialItem)}">
                                    No item will be created, a placeholder for this item will be created. 
                                </p:outputPanel>

                                <p:outputPanel rendered="#{itemDomainInventoryController.isRenderBomExisting(billOfMaterialItem)}">
                                    The list contains available inventory items that are not assigned to any assembly. 
                                    <ui:include src="../item/private/itemSelectDataTable.xhtml">
                                        <ui:param name="selectDataModel" value="#{billOfMaterialItem.existingInventoryItemSelectDataModel}" />
                                        <ui:param name="selectionValue" value="#{billOfMaterialItem.newItem}" />
                                        <ui:param name="selectionController" value="#{itemDomainInventoryController}" />
                                        <ui:param name="viewName" value="BOM" />
                                    </ui:include>
                                </p:outputPanel>

                                <p:outputPanel rendered="#{itemDomainInventoryController.isRenderBomNew(billOfMaterialItem)}">

                                    <ui:include src="private/itemBillOfMaterialsNewItemPanel.xhtml">
                                        <ui:param name="itemObject" value="#{billOfMaterialItem.newItem}"/>
                                        <ui:param name="viewName" value="BOMInstance" />
                                    </ui:include>
                                </p:outputPanel>

                            </p:outputPanel>
                            <p:outputPanel rendered="#{itemDomainInventoryController.selectedItemBOMTreeNode == null}">
                                <div>
                                    <h1 style="padding: 15px; padding-bottom: 20px; color: #4e80b6;">Please Select a part from parts list to begin.</h1>
                                </div>
                            </p:outputPanel>
                        </p:column>
                    </p:row>

                </p:panelGrid>

                <div class="actionButton">
                    <p:commandButton id="#{entityTypeName}CreateSaveButton" action="#{entityController.create()}" 
                                     value="Save Current Progress" alt="Save" icon="ui-icon-check" update="@form">
                        <p:tooltip for="#{entityTypeName}CreateSaveButton" value="Save new #{entityController.displayEntityTypeName}."/>
                    </p:commandButton>
                </div>


            </p:outputPanel>

        </p:tab>
    </ui:define>

</ui:composition>


